# 🔐 环境变量配置指南

## 📋 概述

联系表单需要配置第三方服务（Formspree 或 Web3Forms）的环境变量才能正常工作。

## 🚀 快速配置步骤

### 步骤 1: 选择服务并获取配置信息

#### 选项 A: Formspree（推荐）

1. 访问 [https://formspree.io](https://formspree.io)
2. 注册并登录
3. 创建新表单：
   - 表单名称：`iSperm Contact Form`
   - 接收邮箱：`market@isperm.com`
4. 获取表单 ID（格式：`xxxxxxxxxx`）

#### 选项 B: Web3Forms（备选）

1. 访问 [https://web3forms.com](https://web3forms.com)
2. 输入邮箱：`market@isperm.com`
3. 点击 "Get Your Access Key"
4. 复制生成的 Access Key

### 步骤 2: 在 GitHub 仓库中配置 Secrets

1. 打开您的 GitHub 仓库
2. 点击 **Settings**（设置）
3. 在左侧菜单找到 **Secrets and variables** > **Actions**
4. 点击 **New repository secret**

#### 如果使用 Formspree：
- **Name**: `NEXT_PUBLIC_FORMSPREE_ID`
- **Value**: 您的 Formspree 表单 ID（例如：`abc123xyz`）
- 点击 **Add secret**

#### 如果使用 Web3Forms：
- **Name**: `NEXT_PUBLIC_WEB3FORMS_KEY`
- **Value**: 您的 Web3Forms Access Key
- 点击 **Add secret**

### 步骤 3: 验证配置

1. 推送代码到 GitHub（如果还没有）
2. 查看 **Actions** 标签页
3. 等待部署完成
4. 测试联系表单是否正常工作

## 📝 本地开发配置

对于本地开发，创建 `.env.local` 文件（项目根目录）：

```env
# Formspree（推荐）
NEXT_PUBLIC_FORMSPREE_ID=your_form_id_here

# 或 Web3Forms（备选）
NEXT_PUBLIC_WEB3FORMS_KEY=your_access_key_here
```

**重要**：
- `.env.local` 文件已在 `.gitignore` 中，不会被提交到 Git
- 不要将真实的密钥提交到代码仓库
- 本地开发时，环境变量会自动加载

## 🔍 环境变量优先级

代码会按以下优先级选择服务：

1. **Formspree** - 如果配置了 `NEXT_PUBLIC_FORMSPREE_ID`
2. **Web3Forms** - 如果配置了 `NEXT_PUBLIC_WEB3FORMS_KEY`
3. **错误** - 如果都没有配置，表单会显示错误

## ✅ 验证清单

- [ ] 已在 GitHub Secrets 中配置环境变量
- [ ] 已测试本地开发环境（使用 `.env.local`）
- [ ] 已部署到 GitHub Pages
- [ ] 已测试联系表单提交功能
- [ ] 已确认邮件能正常收到

## 🆘 常见问题

### Q: 环境变量没有生效？

**A**: 检查以下几点：
1. Secret 名称是否正确（区分大小写）
2. 是否已重新部署（环境变量更改后需要重新构建）
3. 浏览器控制台是否有错误信息

### Q: 表单提交失败？

**A**: 
1. 检查 Formspree/Web3Forms 后台是否有提交记录
2. 检查浏览器控制台错误
3. 确认环境变量已正确配置

### Q: 可以同时配置两个服务吗？

**A**: 可以，但代码会优先使用 Formspree。如果 Formspree ID 存在，就会使用 Formspree；否则使用 Web3Forms。

### Q: 本地开发时如何测试？

**A**: 
1. 创建 `.env.local` 文件
2. 添加环境变量
3. 重启开发服务器（`npm run dev`）
4. 测试表单提交

## 📚 相关文档

- [联系表单解决方案.md](./联系表单解决方案.md) - 详细的方案对比和设置说明
- [GitHub Secrets 文档](https://docs.github.com/en/actions/security-guides/encrypted-secrets)

---

**配置完成后，您的联系表单就可以正常工作了！** 🎉
