# æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•è„šæœ¬

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

1. æ‰“å¼€ç½‘ç«™ï¼š`http://localhost:3000`
2. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ°"æ§åˆ¶å°"ï¼ˆConsoleï¼‰æ ‡ç­¾
4. å¤åˆ¶ä¸‹é¢çš„ä»£ç 
5. ç²˜è´´åˆ°æ§åˆ¶å°å¹¶æŒ‰å›è½¦

---

## ğŸ” å®Œæ•´æµ‹è¯•è„šæœ¬

```javascript
// æœç´¢å†å²åŠŸèƒ½æµ‹è¯•è„šæœ¬
console.log('ğŸ” å¼€å§‹æµ‹è¯•æœç´¢å†å²åŠŸèƒ½...\n');

const STORAGE_KEY = 'isperm_search_history';
const MAX_HISTORY = 20;

// æµ‹è¯• 1: æ£€æŸ¥ localStorage æ˜¯å¦å¯ç”¨
console.log('æµ‹è¯• 1: æ£€æŸ¥ localStorage å¯ç”¨æ€§');
try {
  localStorage.setItem('test', 'test');
  localStorage.removeItem('test');
  console.log('âœ… localStorage å¯ç”¨\n');
} catch (error) {
  console.error('âŒ localStorage ä¸å¯ç”¨:', error);
  console.log('âš ï¸  æœç´¢å†å²åŠŸèƒ½å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ\n');
}

// æµ‹è¯• 2: æŸ¥çœ‹å½“å‰æœç´¢å†å²
console.log('æµ‹è¯• 2: æŸ¥çœ‹å½“å‰æœç´¢å†å²');
try {
  const stored = localStorage.getItem(STORAGE_KEY);
  if (stored) {
    const history = JSON.parse(stored);
    console.log(`âœ… æ‰¾åˆ° ${history.length} æ¡å†å²è®°å½•:`);
    history.slice(0, 5).forEach((item, index) => {
      const date = new Date(item.timestamp);
      console.log(`   ${index + 1}. "${item.query}" - ${item.resultCount || 0} ç»“æœ - ${date.toLocaleString()}`);
    });
    if (history.length > 5) {
      console.log(`   ... è¿˜æœ‰ ${history.length - 5} æ¡è®°å½•`);
    }
  } else {
    console.log('â„¹ï¸  æš‚æ— æœç´¢å†å²');
  }
  console.log('');
} catch (error) {
  console.error('âŒ è¯»å–å†å²å¤±è´¥:', error);
  console.log('');
}

// æµ‹è¯• 3: æ·»åŠ æµ‹è¯•æ•°æ®
console.log('æµ‹è¯• 3: æ·»åŠ æµ‹è¯•æ•°æ®');
try {
  const testQueries = [
    { query: 'Nexus Dx1', count: 5 },
    { query: 'CASA system', count: 10 },
    { query: 'WHO 6th Edition', count: 8 },
    { query: 'Semen analysis', count: 12 },
    { query: 'Sperm morphology', count: 7 }
  ];
  
  testQueries.forEach(({ query, count }) => {
    const stored = localStorage.getItem(STORAGE_KEY);
    const history = stored ? JSON.parse(stored) : [];
    const filtered = history.filter(item => item.query.toLowerCase() !== query.toLowerCase());
    const newItem = {
      query: query,
      timestamp: Date.now() - Math.random() * 10000,
      resultCount: count
    };
    const newHistory = [newItem, ...filtered].slice(0, MAX_HISTORY);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(newHistory));
    console.log(`âœ… æ·»åŠ : "${query}"`);
  });
  console.log('');
} catch (error) {
  console.error('âŒ æ·»åŠ æµ‹è¯•æ•°æ®å¤±è´¥:', error);
  console.log('');
}

// æµ‹è¯• 4: éªŒè¯æ•°æ®ä¿å­˜
console.log('æµ‹è¯• 4: éªŒè¯æ•°æ®ä¿å­˜');
try {
  const stored = localStorage.getItem(STORAGE_KEY);
  const history = JSON.parse(stored);
  console.log(`âœ… å½“å‰æœ‰ ${history.length} æ¡å†å²è®°å½•`);
  console.log('æœ€æ–°3æ¡è®°å½•:');
  history.slice(0, 3).forEach((item, index) => {
    const date = new Date(item.timestamp);
    console.log(`   ${index + 1}. "${item.query}" - ${item.resultCount || 0} ç»“æœ - ${date.toLocaleString()}`);
  });
  console.log('');
} catch (error) {
  console.error('âŒ éªŒè¯å¤±è´¥:', error);
  console.log('');
}

// æµ‹è¯• 5: æµ‹è¯•é‡å¤æœç´¢å¤„ç†
console.log('æµ‹è¯• 5: æµ‹è¯•é‡å¤æœç´¢å¤„ç†');
try {
  const stored = localStorage.getItem(STORAGE_KEY);
  const history = JSON.parse(stored);
  const beforeCount = history.filter(h => h.query.toLowerCase() === 'nexus dx1').length;
  console.log(`   å¤„ç†å‰æœ‰ ${beforeCount} æ¡ "Nexus Dx1" è®°å½•`);
  
  // æ·»åŠ é‡å¤æœç´¢
  const filtered = history.filter(item => item.query.toLowerCase() !== 'nexus dx1');
  const newItem = { query: 'Nexus Dx1', timestamp: Date.now(), resultCount: 15 };
  const newHistory = [newItem, ...filtered].slice(0, MAX_HISTORY);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(newHistory));
  
  const afterHistory = JSON.parse(localStorage.getItem(STORAGE_KEY));
  const afterCount = afterHistory.filter(h => h.query.toLowerCase() === 'nexus dx1').length;
  
  if (afterCount === 1 && afterHistory[0].query === 'Nexus Dx1') {
    console.log('âœ… é‡å¤æœç´¢æ­£ç¡®å¤„ç†ï¼ˆåˆå¹¶ä¸º1æ¡ï¼Œç§»åˆ°æœ€å‰ï¼‰');
  } else {
    console.log('âŒ é‡å¤æœç´¢å¤„ç†å¤±è´¥');
    console.log(`   å¤„ç†å: ${afterCount} æ¡è®°å½•`);
  }
  console.log('');
} catch (error) {
  console.error('âŒ æµ‹è¯•å¤±è´¥:', error);
  console.log('');
}

// æµ‹è¯• 6: æµ‹è¯•æ•°é‡é™åˆ¶
console.log('æµ‹è¯• 6: æµ‹è¯•æ•°é‡é™åˆ¶ï¼ˆæœ€å¤š20æ¡ï¼‰');
try {
  // æ·»åŠ 25æ¡æµ‹è¯•æ•°æ®
  const manyQueries = Array.from({ length: 25 }, (_, i) => ({
    query: `Test Query ${i}`,
    timestamp: Date.now() - i * 1000,
    resultCount: i
  }));
  
  localStorage.setItem(STORAGE_KEY, JSON.stringify(manyQueries));
  const history = JSON.parse(localStorage.getItem(STORAGE_KEY));
  
  if (history.length <= MAX_HISTORY) {
    console.log(`âœ… æ•°é‡é™åˆ¶æ­£ç¡®ï¼ˆå½“å‰ ${history.length} æ¡ï¼Œé™åˆ¶ ${MAX_HISTORY} æ¡ï¼‰`);
  } else {
    console.log(`âŒ æ•°é‡é™åˆ¶å¤±è´¥ï¼ˆå½“å‰ ${history.length} æ¡ï¼Œåº” â‰¤ ${MAX_HISTORY} æ¡ï¼‰`);
  }
  console.log('');
} catch (error) {
  console.error('âŒ æµ‹è¯•å¤±è´¥:', error);
  console.log('');
}

// æµ‹è¯• 7: æµ‹è¯•æ’åº
console.log('æµ‹è¯• 7: æµ‹è¯•æ—¶é—´æ’åº');
try {
  const stored = localStorage.getItem(STORAGE_KEY);
  let history = JSON.parse(stored);
  
  // æŒ‰æ—¶é—´æˆ³æ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
  history = history.sort((a, b) => b.timestamp - a.timestamp);
  
  console.log('âœ… æ’åºåçš„å‰5æ¡è®°å½•:');
  history.slice(0, 5).forEach((item, index) => {
    const date = new Date(item.timestamp);
    console.log(`   ${index + 1}. "${item.query}" - ${date.toLocaleString()}`);
  });
  console.log('');
} catch (error) {
  console.error('âŒ æµ‹è¯•å¤±è´¥:', error);
  console.log('');
}

// æµ‹è¯•æ€»ç»“
console.log('ğŸ“Š æµ‹è¯•æ€»ç»“:');
console.log('âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•å®Œæˆ');
console.log('âœ… æ•°æ®å¤„ç†æµ‹è¯•å®Œæˆ');
console.log('âœ… è¾¹ç•Œæƒ…å†µæµ‹è¯•å®Œæˆ');
console.log('\nğŸ’¡ ä¸‹ä¸€æ­¥:');
console.log('1. æ‰“å¼€ç½‘ç«™æœç´¢æ¡†æŸ¥çœ‹å†å²è®°å½•');
console.log('2. æ‰§è¡Œå‡ æ¬¡æœç´¢ï¼Œè§‚å¯Ÿå†å²è®°å½•å˜åŒ–');
console.log('3. æµ‹è¯•åˆ é™¤å’Œæ¸…é™¤åŠŸèƒ½');
console.log('4. åˆ·æ–°é¡µé¢éªŒè¯æ•°æ®æŒä¹…åŒ–');
console.log('\nâœ¨ æµ‹è¯•å®Œæˆï¼');
```

---

## ğŸ“ å¿«é€Ÿæµ‹è¯•å‘½ä»¤

### æŸ¥çœ‹å†å²è®°å½•
```javascript
JSON.parse(localStorage.getItem('isperm_search_history'))
```

### æ·»åŠ æµ‹è¯•æ•°æ®
```javascript
const data = [
  { query: 'Nexus Dx1', timestamp: Date.now(), resultCount: 5 },
  { query: 'CASA system', timestamp: Date.now() - 1000, resultCount: 10 }
];
localStorage.setItem('isperm_search_history', JSON.stringify(data));
```

### æ¸…é™¤å†å²
```javascript
localStorage.removeItem('isperm_search_history');
console.log('âœ… å†å²è®°å½•å·²æ¸…é™¤');
```

---

## ğŸ¯ æµ‹è¯•æ­¥éª¤

1. **å¤åˆ¶ä¸Šé¢çš„å®Œæ•´æµ‹è¯•è„šæœ¬**
2. **æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°**ï¼ˆF12ï¼‰
3. **ç²˜è´´è„šæœ¬å¹¶å›è½¦**
4. **æŸ¥çœ‹æµ‹è¯•ç»“æœ**
5. **æ‰“å¼€æœç´¢æ¡†éªŒè¯**ï¼ˆç‚¹å‡»æœç´¢å›¾æ ‡ï¼‰

---

## âœ… é¢„æœŸè¾“å‡º

æµ‹è¯•è„šæœ¬ä¼šè¾“å‡ºï¼š
- âœ… localStorage å¯ç”¨æ€§æ£€æŸ¥
- âœ… å½“å‰å†å²è®°å½•åˆ—è¡¨
- âœ… æ·»åŠ æµ‹è¯•æ•°æ®
- âœ… éªŒè¯æ•°æ®ä¿å­˜
- âœ… é‡å¤æœç´¢å¤„ç†
- âœ… æ•°é‡é™åˆ¶æµ‹è¯•
- âœ… æ—¶é—´æ’åºæµ‹è¯•

å¦‚æœæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œä¼šæ˜¾ç¤ºï¼š
```
ğŸ“Š æµ‹è¯•æ€»ç»“:
âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•å®Œæˆ
âœ… æ•°æ®å¤„ç†æµ‹è¯•å®Œæˆ
âœ… è¾¹ç•Œæƒ…å†µæµ‹è¯•å®Œæˆ
```

---

**ç°åœ¨å¤åˆ¶ä¸Šé¢çš„è„šæœ¬åˆ°æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œå§ï¼** ğŸš€
